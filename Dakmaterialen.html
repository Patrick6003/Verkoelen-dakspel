<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>Vinky V Dakspel (Verbeterd Startknop + PromotieTeller)</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #f0f0f0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: start;
    }
    /* Bovenbalk: Highscore + Pauzeknop */
    #topBar {
      width: 100%;
      max-width: 400px;
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-family: Arial, sans-serif;
    }
    #highScoreLabel {
      font-size: 14px;
      margin: 0 10px;
    }
    #pauseBtn {
      margin: 0 10px;
      font-size: 14px;
      padding: 4px 8px;
      cursor: pointer;
    }
    /* Canvas is in "echte" pixels 400×600, maar schaalt naar max 400px breed */
    canvas {
      border: 1px solid #000;
      width: 100%;
      max-width: 400px;
      height: auto;
      display: block;
      margin-top: 10px;
      background-color: #595A5C; /* fallback */
    }
    /* Scoreboard onder het spel */
    #scoreBoard {
      margin-top: 10px;
      font-family: Arial, sans-serif;
      text-align: center;
    }
    #scoreBoard p {
      margin: 5px;
      font-size: 16px;
    }

    /* Overlay voor de Startknop */
    #startOverlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: rgba(0,0,0,0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    #startOverlayContent {
      background-color: #fff;
      padding: 20px;
      max-width: 320px;
      border-radius: 6px;
      text-align: center;
      font-family: Arial, sans-serif;
    }
    #startOverlayContent button {
      margin-top: 10px;
      padding: 8px 12px;
      font-size: 16px;
      cursor: pointer;
    }

    /* Uitleg helemaal onderaan de pagina */
    #gameInfo {
      max-width: 400px;
      font-family: Arial, sans-serif;
      font-size: 14px;
      background-color: #eee;
      padding: 10px;
      margin-top: 20px;
      text-align: left;
    }
  </style>
</head>
<body>

  <!-- Overlay/Pop-up met Startknop -->
  <div id="startOverlay">
    <div id="startOverlayContent">
      <h2>Welkom bij het Vinky V Dakspel</h2>
      <p>De hijskraan is op tilt geslagen! Help Vinky V om alle materialen te vangen zodat de dakrenovatie kan doorgaan.<br/>
         Klik op Start om te beginnen.</p>
      <button id="startGameBtn">Start spel</button>
    </div>
  </div>

  <!-- Bovenbalk: Highscore + Pauzeknop -->
  <div id="topBar">
    <div id="highScoreLabel">Highscore: <span id="highScoreSpan">0</span></div>
    <button id="pauseBtn">Pauze</button>
  </div>

  <!-- Canvas voor het spel -->
  <canvas id="gameCanvas" width="400" height="600"></canvas>

  <!-- ScoreBoard met ook promoties -->
  <div id="scoreBoard">
    <p>
      Gasflessen: <span id="gasflesCount">0</span> |
      Dakrollen: <span id="dakrolCount">0</span> |
      Schroeven: <span id="schroefCount">0</span> |
      PIR-platen: <span id="pirCount">0</span> |
      Salaris: <span id="powerUpCount">0</span> |
      <strong>Promoties:</strong> <span id="promotieCount">0</span>
    </p>
  </div>

  <!-- Uitleg onderaan -->
  <div id="gameInfo">
    <strong>Levels:</strong><br/>
    1. Level 1 (&lt; 1000): Normaal<br/>
    2. Level 2 (&ge; 1000): Kraan beweegt willekeurig<br/>
    3. Level 3 (&ge; 1500): Kraan hangt lager<br/>
    4. Level 4 (&ge; 2000): Kraan nóg lager<br/>
    5. Level 5 (&ge; 3000): Wind & mist<br/>
    6. Level 6 (&ge; 4000): Donker<br/>
    7. Level 7 (&ge; 5000): Regen in het donker<br/>
    8. Level 8 (&ge; 6000): Storm (bliksem kan Vinky verlammen!)<br/><br/>

    <strong>Objecten & Punten:</strong><br/>
    - Gasfles: 15 punten<br/>
    - Dakrol: 30 punten<br/>
    - Schroef: 10 punten<br/>
    - PIR-plaat: 25 punten<br/>
    - Salaris (geldzak): +1 leven (Vinky juicht!)<br/>
    - Promotie (kroon): +1 leven, tijdelijk grotere Vinky & extra kraanhaak (Vinky juicht!)<br/><br/>
    Mis je een object (behalve Salaris of Promotie), dan verlies je 1 leven.  
    Als je levens op zijn, is het game over.<br/>
    Veel succes!
  </div>

  <script>
    // -----------------------------
    //   GLOBALE VARIABELEN
    // -----------------------------
    const startOverlay = document.getElementById('startOverlay');
    const startGameBtn = document.getElementById('startGameBtn');
    const pauseBtn     = document.getElementById('pauseBtn');
    const canvas       = document.getElementById('gameCanvas');
    const ctx          = canvas.getContext('2d');

    let gameStarted = false;
    let paused      = false;
    let gameOver    = false;

    // StartOverlay
    startGameBtn.addEventListener('click', () => {
      // Verberg overlay
      startOverlay.style.display = 'none';
      // Start het spel echt
      gameStarted = true;
      paused = false;
      gameOver = false;
    });

    // Pauzeknop
    pauseBtn.addEventListener('click', () => {
      if (!gameStarted || gameOver) return;
      paused = !paused;
      pauseBtn.textContent = paused ? 'Ga verder' : 'Pauze';
    });

    // Highscore
    let highScore = 0;
    if (localStorage.getItem('vinkyHighScore')) {
      highScore = parseInt(localStorage.getItem('vinkyHighScore'), 10);
    }
    document.getElementById('highScoreSpan').textContent = String(highScore);

    // Score & Levens
    let score = 0;
    let lives = 3;
    function updateHighScoreIfNeeded() {
      if (score > highScore) {
        highScore = score;
        localStorage.setItem('vinkyHighScore', String(highScore));
        document.getElementById('highScoreSpan').textContent = String(highScore);
      }
    }

    // Besturing & Player
    let vinkyX = 175, vinkyY = 550;
    let vinkyWidth  = 50, vinkyHeight = 50;
    const originalVinkyWidth  = 50;
    const originalVinkyHeight = 50;

    let vinkyCheerTimer   = 0;
    let vinkyStunnedTimer = 0; // door bliksem

    // Levels
    let currentLevel  = 1;
    let previousLevel = 1;
    let levelChangeTimer = 0; // melding "LEVEL X!"
    
    // Kraan 1
    let hookX=0, hookY=10;
    let hookWidth=10, hookHeight=20;
    let hookSpeed=2;
    let hookDirection=1;
    let randomCraneTimer=0;

    // Kraan 2 (promotie)
    let twoHooksActive=false;
    let twoHooksTimer=0;
    let hook2X=380, hook2Y=10;
    let hook2Width=10, hook2Height=20;
    let hook2Speed=2, hook2Direction=-1;

    // Promotie
    let promotieActive=false;
    let promotieTimer=0;
    let forcedPromotionGiven=false; // we forceren er 1 als je >1200 punten haalt

    // Wind / regen / storm
    let windSpeed=0, windDirection=1, windChangeTimer=0;
    let raindrops=[];
    for (let i=0; i<50; i++){
      raindrops.push({ x:Math.random()*400, y:Math.random()*600, speed:3+Math.random()*2 });
    }
    let lightningActive=false;
    let lightningX=0;
    let lightningTimer=0;
    let randomLightningTimer=300;

    // Score & object-counters
    let gasflesCount=0, dakrolCount=0, schroefCount=0, pirCount=0, powerUpCount=0;
    let promotieCount=0; // nieuwe teller

    // Objecttypes
    const objectTypes = {
      gasfles:  { points:15, width:20, height:40 },
      dakrol:   { points:30, width:15, height:40 },
      schroef:  { points:10, width:10, height:20 },
      pir:      { points:25, width:30, height:20 },
      powerUp:  { points: 0, width:20, height:20 },
      promotie: { points: 0, width:20, height:20 }
    };

    // Wolken
    let clouds = [
      { x:60,  y:70,  size:1.0 },
      { x:200, y:50,  size:1.2 },
      { x:300, y:80,  size:1.1 }
    ];

    // Audio
    const catchSound = new Audio('catch.mp3');
    const missSound  = new Audio('miss.mp3');

    // Besturing (muis/touch)
    canvas.addEventListener('touchmove', e => {
      e.preventDefault();
      if(!gameStarted || gameOver || paused) return;
      if(vinkyStunnedTimer>0) return;
      if(e.touches.length>0){
        moveVinky(e.touches[0].clientX, e.touches[0].clientY);
      }
    });
    canvas.addEventListener('touchstart', e => {
      e.preventDefault();
      if(!gameStarted || gameOver || paused) return;
      if(vinkyStunnedTimer>0) return;
      if(e.touches.length>0){
        moveVinky(e.touches[0].clientX, e.touches[0].clientY);
      }
    });
    canvas.addEventListener('mousemove', e => {
      if(!gameStarted || gameOver || paused) return;
      if(vinkyStunnedTimer>0) return;
      moveVinky(e.clientX, e.clientY);
    });

    function moveVinky(clientX, clientY){
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      let desiredX = (clientX - rect.left)*scaleX - vinkyWidth/2;
      if(desiredX<0) desiredX=0;
      if(desiredX>canvas.width-vinkyWidth) desiredX=canvas.width-vinkyWidth;
      vinkyX = desiredX;
    }

    // Opnieuw-knop
    canvas.addEventListener('click', e => {
      if(!gameOver) return;
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      const scaleY = canvas.height/ rect.height;
      const clickX = (e.clientX - rect.left)*scaleX;
      const clickY = (e.clientY - rect.top)*scaleY;
      // bounding box (150..250, 275..325)
      if(clickX>150 && clickX<250 && clickY>275 && clickY<325){
        restartGame();
      }
    });

    // Gameloop
    function gameLoop(){
      if(gameStarted && !paused && !gameOver){
        updateLevel();
        updateHook();
        if(twoHooksActive) updateHook2();

        spawnObject();
        forcePromotionIfNeeded();
        updateObjects();
        updatePromotie();
        updateWindAndEffects();
        moveClouds();
        if(currentLevel>=7) updateRain();
        if(currentLevel>=8) updateLightning();
        updateStun();

        checkGameOver();
      }

      // Tekenen
      drawBackground();
      drawCraneBar();
      drawHook();
      if(twoHooksActive) drawHook2();
      drawFlatRoof();
      drawVinkyV();
      drawObjects();
      drawScore();
      drawLives();

      // Level-change melding
      if(levelChangeTimer>0){
        levelChangeTimer--;
        drawLevelUpMessage();
      }
      // Game Over => opnieuw-knop
      if(gameOver) drawRestartButton();

      updateScoreBoard();
      requestAnimationFrame(gameLoop);
    }
    requestAnimationFrame(gameLoop); // Start de animatie-lus

    // -----------------------------
    //    FUNCTIES
    // -----------------------------

    function updateLevel(){
      previousLevel = currentLevel;
      if(score>=6000) currentLevel=8;
      else if(score>=5000) currentLevel=7;
      else if(score>=4000) currentLevel=6;
      else if(score>=3000) currentLevel=5;
      else if(score>=2000) currentLevel=4;
      else if(score>=1500) currentLevel=3;
      else if(score>=1000) currentLevel=2;
      else currentLevel=1;

      if(currentLevel>previousLevel){
        levelChangeTimer=90; 
        vinkyCheerTimer=60; 
      }
    }
    function drawLevelUpMessage(){
      ctx.font='24px Arial';
      ctx.fillStyle='#FF0000';
      const msg='LEVEL '+currentLevel+'!';
      const w=ctx.measureText(msg).width;
      ctx.fillText(msg, canvas.width/2 - w/2, 50);
    }

    function forcePromotionIfNeeded(){
      // bij ~1200+ punten, als je nog geen promotie hebt gevangen: spawn er 1.
      if(!forcedPromotionGiven && score>=1200 && promotieCount===0){
        forcedPromotionGiven=true;
        spawnOneObject('promotie', hookX, hookY);
      }
    }
    function spawnObject(){
      // Haak1 ~1% kans
      if(Math.random()<0.01){
        spawnOneRandom(hookX, hookY);
      }
      // Haak2
      if(twoHooksActive && Math.random()<0.01){
        spawnOneRandom(hook2X, hook2Y);
      }
    }
    function spawnOneRandom(hx, hy){
      const rand=Math.random();
      let type;
      if(rand<0.003)      type='promotie';
      else if(rand<0.02)  type='powerUp';
      else if(rand<0.17)  type='gasfles';
      else if(rand<0.47)  type='dakrol';
      else if(rand<0.80)  type='pir';
      else                type='schroef';

      let baseSpeed=3;
      let variation=0;
      switch(currentLevel){
        case 1: variation=0.5; break;
        case 2: variation=1.0; break;
        case 3: variation=1.5; break;
        case 4: variation=2.0; break;
        case 5: variation=3.0; break;
        case 6: variation=4.0; break;
        case 7: variation=5.0; break;
        case 8: variation=6.0; break;
      }
      let finalSpeed= baseSpeed + Math.random()*variation;
      let effY = hy+hookHeight;
      if(currentLevel>=3) effY+=30;
      if(currentLevel>=4) effY+=30;
      const x= hx + hookWidth/2 - objectTypes[type].width/2;

      objects.push({
        type,
        x,
        y: effY,
        speed: finalSpeed,
        points: objectTypes[type].points,
        width: objectTypes[type].width,
        height: objectTypes[type].height
      });
    }
    function spawnOneObject(t, hx, hy){
      let baseSpeed=3; let variation=2+Math.random()*2;
      let finalSpeed= baseSpeed+variation;
      let effY= hy+hookHeight;
      if(currentLevel>=3) effY+=30;
      if(currentLevel>=4) effY+=30;
      const x = hx + hookWidth/2 - objectTypes[t].width/2;

      objects.push({
        type: t,
        x,
        y: effY,
        speed: finalSpeed,
        points: objectTypes[t].points,
        width: objectTypes[t].width,
        height:objectTypes[t].height
      });
    }

    // Kraan1
    function updateHook(){
      hookX+=hookDirection*hookSpeed;
      if(hookX<0){ hookX=0; hookDirection=1; }
      else if(hookX+hookWidth>canvas.width){ hookX=canvas.width-hookWidth; hookDirection=-1; }
      if(currentLevel>=2){
        randomCraneTimer--;
        if(randomCraneTimer<=0){
          randomCraneTimer=60+Math.floor(Math.random()*60);
          hookDirection=(Math.random()<0.5)?1:-1;
          hookSpeed=2+Math.random()*2;
        }
      }
    }
    // Kraan2
    function updateHook2(){
      hook2X+=hook2Direction*hook2Speed;
      if(hook2X<0){ hook2X=0; hook2Direction=1; }
      else if(hook2X+hook2Width>canvas.width){ hook2X=canvas.width-hook2Width; hook2Direction=-1; }
      if(currentLevel>=2){
        if(Math.random()<0.01){
          hook2Direction=(Math.random()<0.5)?1:-1;
          hook2Speed=2+Math.random()*2;
        }
      }
    }

    // Objecten updaten
    function updateObjects(){
      for(let i=objects.length-1; i>=0; i--){
        let obj=objects[i];
        // wind
        if(currentLevel>=5 && windSpeed!==0){
          obj.x+= windSpeed*windDirection;
          if(obj.x<0) obj.x=0;
          if(obj.x+obj.width>canvas.width) obj.x=canvas.width-obj.width;
        }
        // vallen
        obj.y+=obj.speed;

        // vangst?
        if(
          obj.y+obj.height>vinkyY &&
          obj.y< vinkyY+vinkyHeight &&
          obj.x+obj.width>vinkyX &&
          obj.x< vinkyX+vinkyWidth
        ){
          catchSound.currentTime=0; catchSound.play().catch(()=>{});
          if(obj.type==='powerUp'){
            // +1 leven, juich
            lives++;
            powerUpCount++;
            vinkyCheerTimer=30;
          } else if(obj.type==='promotie'){
            // +1 leven, 2 hooks, Vinky groter, juich
            lives++;
            promotieCount++; // tel promotie
            activatePromotie();
            vinkyCheerTimer=30;
          } else {
            score+=obj.points;
            if(obj.type==='gasfles') gasflesCount++;
            if(obj.type==='dakrol')  dakrolCount++;
            if(obj.type==='schroef') schroefCount++;
            if(obj.type==='pir')     pirCount++;
          }
          objects.splice(i,1);
        }
        else if(obj.y>canvas.height){
          // gemist
          if(obj.type!=='powerUp' && obj.type!=='promotie'){
            lives--;
            missSound.currentTime=0; missSound.play().catch(()=>{});
          }
          objects.splice(i,1);
        }
      }
    }

    // Promotie => 5s
    function activatePromotie(){
      twoHooksActive=true;
      twoHooksTimer=300;
      promotieActive=true;
      promotieTimer=300;
      vinkyWidth = originalVinkyWidth*1.3;
      vinkyHeight= originalVinkyHeight*1.3;
    }
    function updatePromotie(){
      if(promotieActive){
        promotieTimer--;
        if(promotieTimer<=0){
          promotieActive=false;
          vinkyWidth= originalVinkyWidth;
          vinkyHeight=originalVinkyHeight;
        }
      }
      if(twoHooksActive){
        twoHooksTimer--;
        if(twoHooksTimer<=0){
          twoHooksActive=false;
        }
      }
    }

    // Wind & Mist
    function updateWindAndEffects(){
      if(currentLevel<5){
        windSpeed=0;
      } else {
        if(windSpeed===0) windSpeed=0.3;
        windChangeTimer--;
        if(windChangeTimer<=0){
          windChangeTimer=120+Math.floor(Math.random()*120);
          windDirection=(Math.random()<0.5)?1:-1;
          windSpeed=0.2+Math.random()*0.5;
        }
      }
    }
    // Regen
    function updateRain(){
      for(let r of raindrops){
        r.y+=r.speed;
        if(r.y>600){
          r.x=Math.random()*400;
          r.y=-10;
          r.speed=3+Math.random()*2;
        }
      }
    }
    function drawRain(){
      ctx.strokeStyle='rgba(200,200,255,0.5)';
      ctx.lineWidth=1;
      for(let r of raindrops){
        ctx.beginPath();
        ctx.moveTo(r.x, r.y);
        ctx.lineTo(r.x+2, r.y+8);
        ctx.stroke();
      }
    }
    // Storm/Bliksem
    function updateLightning(){
      if(currentLevel<8) return;
      if(!lightningActive){
        randomLightningTimer--;
        if(randomLightningTimer<=0){
          lightningActive=true;
          lightningX=Math.random()*canvas.width;
          lightningTimer=15;
          randomLightningTimer=300+Math.floor(Math.random()*300);
          // check of vinky geraakt
          if(vinkyX+vinkyWidth>lightningX-25 && vinkyX<lightningX+25){
            vinkyStunnedTimer=120;
          }
        }
      } else {
        lightningTimer--;
        if(lightningTimer<=0){
          lightningActive=false;
        }
      }
    }
    function drawLightning(){
      if(!lightningActive) return;
      ctx.strokeStyle='yellow';
      ctx.lineWidth=3;
      ctx.beginPath();
      ctx.moveTo(lightningX,0);
      ctx.lineTo(lightningX, vinkyY+20);
      ctx.stroke();

      ctx.lineWidth=2;
      ctx.beginPath();
      ctx.moveTo(lightningX, canvas.height*0.2);
      ctx.lineTo(lightningX+(Math.random()*40-20), canvas.height*0.3);
      ctx.stroke();
    }
    // Stun
    function updateStun(){
      if(vinkyStunnedTimer>0) vinkyStunnedTimer--;
    }

    // Check game over
    function checkGameOver(){
      if(lives<=0 && !gameOver){
        alert("Game Over! Je score is: "+score);
        updateHighScoreIfNeeded();
        gameOver=true;
      }
    }

    // Teken Achtergrond
    function drawBackground(){
      let skyColor;
      if(currentLevel<5) skyColor='#87CEEB';
      else if(currentLevel===5) skyColor='#87CEEB';
      else if(currentLevel===6) skyColor='#444444';
      else if(currentLevel===7) skyColor='#2F2F2F';
      else skyColor='#1C1C1C';

      ctx.fillStyle=skyColor;
      ctx.fillRect(0,0, canvas.width, canvas.height);

      // Zon
      if(currentLevel<6){
        ctx.fillStyle='#FFD700';
        ctx.beginPath();
        ctx.arc(canvas.width-50,50,30,0,2*Math.PI);
        ctx.fill();
      }
      // Wolken
      for(let c of clouds){
        drawCloud(c.x, c.y, c.size);
      }
      // Mist
      if(currentLevel===5){
        ctx.fillStyle='rgba(200,200,200,0.3)';
        ctx.fillRect(0,0, canvas.width, canvas.height);
      }
      // Donker overlay
      if(currentLevel>=6){
        ctx.fillStyle='rgba(0,0,0,0.4)';
        ctx.fillRect(0,0, canvas.width, canvas.height);
      }
      // Regen
      if(currentLevel>=7){
        drawRain();
      }
      // Bliksem
      if(currentLevel>=8){
        drawLightning();
      }
    }
    function drawCloud(cx, cy, size=1.0){
      ctx.fillStyle='#FFF';
      ctx.beginPath();
      ctx.arc(cx, cy, 20*size, 0, 2*Math.PI);
      ctx.arc(cx+15*size, cy, 25*size, 0, 2*Math.PI);
      ctx.arc(cx-15*size, cy+10*size, 25*size, 0, 2*Math.PI);
      ctx.fill();
    }
    // Kraanbalk
    function drawCraneBar(){
      ctx.fillStyle='#FFD700';
      ctx.fillRect(0,0, canvas.width, 10);
    }
    // Dak
    function drawFlatRoof(){
      ctx.fillStyle='#444';
      ctx.fillRect(0,580, canvas.width, 20);
    }
    // Haak
    function drawHook(){
      ctx.strokeStyle='#808080';
      ctx.beginPath();
      ctx.moveTo(hookX+hookWidth/2, 0);
      ctx.lineTo(hookX+hookWidth/2, hookY);
      ctx.stroke();

      ctx.fillStyle='#808080';
      ctx.fillRect(hookX, hookY, hookWidth, hookHeight);
    }
    // Haak2
    function drawHook2(){
      ctx.strokeStyle='#808080';
      ctx.beginPath();
      ctx.moveTo(hook2X+hook2Width/2,0);
      ctx.lineTo(hook2X+hook2Width/2,hook2Y);
      ctx.stroke();

      ctx.fillStyle='#808080';
      ctx.fillRect(hook2X, hook2Y, hook2Width, hook2Height);
    }
    // Vinky V
    function drawVinkyV(){
      ctx.save();
      ctx.translate(vinkyX+vinkyWidth/2, vinkyY+vinkyHeight/2);

      // Oranje V
      ctx.fillStyle='#F36F21';
      ctx.beginPath();
      ctx.moveTo(-vinkyWidth/2, -vinkyHeight/2);
      ctx.lineTo(0, vinkyHeight/2);
      ctx.lineTo(vinkyWidth/2, -vinkyHeight/2);
      ctx.closePath();
      ctx.fill();

      // Uitsparing
      ctx.fillStyle=getVinkyInsideColor();
      ctx.beginPath();
      ctx.moveTo(-vinkyWidth*0.2, -vinkyHeight/2);
      ctx.lineTo(0, vinkyHeight*0.15);
      ctx.lineTo(vinkyWidth*0.2, -vinkyHeight/2);
      ctx.closePath();
      ctx.fill();

      if(vinkyCheerTimer>0){
        drawVinkyEyesClosed(-vinkyWidth*0.25, vinkyWidth*0.25, -vinkyHeight*0.1);
        drawVinkyHands(-vinkyWidth/2, vinkyWidth/2, -vinkyHeight/2 -5);
      } else {
        drawVinkyEyesOpen(-vinkyWidth*0.25, vinkyWidth*0.25, -vinkyHeight*0.1);
        drawVinkyHands(-vinkyWidth/2, vinkyWidth/2, -vinkyHeight/4);
      }

      ctx.restore();
    }
    function getVinkyInsideColor(){
      if(currentLevel<5) return '#87CEEB';
      else if(currentLevel===5) return '#A0A0A0';
      else if(currentLevel===6) return '#444444';
      else if(currentLevel===7) return '#2F2F2F';
      else return '#1C1C1C';
    }
    function drawVinkyEyesOpen(leftX, rightX, eyeY){
      ctx.fillStyle='#FFF';
      ctx.beginPath();
      ctx.arc(leftX, eyeY,4,0,2*Math.PI);
      ctx.arc(rightX,eyeY,4,0,2*Math.PI);
      ctx.fill();
      ctx.fillStyle='#00F';
      ctx.beginPath();
      ctx.arc(leftX, eyeY,2,0,2*Math.PI);
      ctx.arc(rightX, eyeY,2,0,2*Math.PI);
      ctx.fill();
    }
    function drawVinkyEyesClosed(leftX, rightX, eyeY){
      ctx.strokeStyle='#000';
      ctx.lineWidth=2;
      ctx.beginPath();
      ctx.moveTo(leftX-2, eyeY);
      ctx.lineTo(leftX+2, eyeY);
      ctx.moveTo(rightX-2, eyeY);
      ctx.lineTo(rightX+2, eyeY);
      ctx.stroke();
    }
    function drawVinkyHands(leftX, rightX, handY){
      ctx.fillStyle='#FFF';
      ctx.beginPath();
      ctx.arc(leftX-5, handY,5,0,2*Math.PI);
      ctx.fill();
      ctx.beginPath();
      ctx.arc(rightX+5, handY,5,0,2*Math.PI);
      ctx.fill();
    }

    // Objecten
    function drawObjects(){
      for(let obj of objects){
        if(obj.type==='gasfles'){
          ctx.fillStyle='#A9A9A9';
          ctx.fillRect(obj.x,obj.y, obj.width,obj.height);
          ctx.fillStyle='#7F7F7F';
          ctx.fillRect(obj.x+obj.width/4, obj.y-5, obj.width/2, 5);

        } else if(obj.type==='dakrol'){
          ctx.fillStyle='#000';
          ctx.fillRect(obj.x,obj.y, obj.width,obj.height);
          ctx.fillStyle='#FFF';
          ctx.fillRect(obj.x, obj.y+obj.height/2-2, obj.width,4);

        } else if(obj.type==='schroef'){
          ctx.fillStyle='#00F';
          ctx.fillRect(obj.x,obj.y, obj.width, obj.height*0.4);
          ctx.fillStyle='#C0C0C0';
          ctx.fillRect(obj.x+obj.width/4, obj.y+obj.height*0.4, obj.width/2, obj.height*0.6);

        } else if(obj.type==='pir'){
          ctx.fillStyle='#EEE8AA';
          ctx.fillRect(obj.x,obj.y, obj.width,obj.height);
          ctx.strokeStyle='#BDB76B';
          ctx.strokeRect(obj.x,obj.y, obj.width,obj.height);

        } else if(obj.type==='powerUp'){
          // Geldzak
          const cx=obj.x+obj.width/2;
          const cy=obj.y+obj.height/2;
          const r=obj.width/2;
          ctx.fillStyle='#8B4513';
          ctx.beginPath();
          ctx.ellipse(cx, cy+2, r, r*1.2, 0,0,2*Math.PI);
          ctx.fill();
          ctx.fillStyle='#654321';
          ctx.fillRect(cx-r*0.6, cy-r*0.6, r*1.2, r*0.4);
          ctx.fillStyle='#FF0';
          ctx.font='10px Arial';
          ctx.fillText('+1', cx-6, cy+4);

        } else if(obj.type==='promotie'){
          // Kroon
          ctx.fillStyle='#FFD700';
          ctx.beginPath();
          ctx.fillRect(obj.x, obj.y+obj.height/2, obj.width, obj.height/2);
          ctx.moveTo(obj.x, obj.y+obj.height/2);
          ctx.lineTo(obj.x+obj.width*0.2, obj.y);
          ctx.lineTo(obj.x+obj.width*0.5, obj.y+obj.height*0.5);
          ctx.lineTo(obj.x+obj.width*0.8, obj.y);
          ctx.lineTo(obj.x+obj.width, obj.y+obj.height/2);
          ctx.closePath();
          ctx.fill();

          ctx.fillStyle='#000';
          ctx.font='10px Arial';
          ctx.fillText('+1 life', obj.x-5, obj.y+obj.height/2 -2);
        }
      }
    }

    // Score & Levens in canvas
    function drawScore(){
      ctx.font='20px Arial';
      ctx.fillStyle='#000';
      ctx.fillText('Score: '+score, 10,70);
    }
    function drawLives(){
      ctx.font='20px Arial';
      ctx.fillStyle='#000';
      ctx.fillText('Levens: '+lives, 10,95);
    }

    // Opnieuw-knop
    function drawRestartButton(){
      ctx.fillStyle='#FFF';
      ctx.fillRect(150,275,100,50);
      ctx.fillStyle='#003087';
      ctx.font='20px Arial';
      ctx.fillText('Opnieuw',165,305);
    }

    // Scoreboard in de DOM updaten
    function updateScoreBoard(){
      document.getElementById('gasflesCount').textContent  = gasflesCount;
      document.getElementById('dakrolCount').textContent   = dakrolCount;
      document.getElementById('schroefCount').textContent  = schroefCount;
      document.getElementById('pirCount').textContent      = pirCount;
      document.getElementById('powerUpCount').textContent  = powerUpCount;
      document.getElementById('promotieCount').textContent = promotieCount;
    }

    // Herstart
    function restartGame(){
      score=0; lives=3; objects=[]; gameOver=false;
      currentLevel=1; previousLevel=1; levelChangeTimer=0;
      vinkyCheerTimer=0; vinkyStunnedTimer=0;

      forcedPromotionGiven=false;
      promotieCount=0;
      twoHooksActive=false; twoHooksTimer=0;
      promotieActive=false; promotieTimer=0;
      vinkyWidth= originalVinkyWidth;
      vinkyHeight=originalVinkyHeight;
      vinkyX=175;

      hookX=0; hookSpeed=2; hookDirection=1; randomCraneTimer=0;
      hook2X=380; hook2Speed=2; hook2Direction=-1;

      windSpeed=0; windDirection=1; windChangeTimer=0;
      lightningActive=false; lightningTimer=0; randomLightningTimer=300;

      gasflesCount=0; dakrolCount=0; schroefCount=0; pirCount=0; powerUpCount=0;
    }
  </script>
</body>
</html>
